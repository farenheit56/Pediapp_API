(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"5af5":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row"},[i("div",{staticClass:"col-3"},[i("q-card",{staticClass:"table-bg no-shadow"},[i("q-card-section",[i("div",{staticClass:"text-h6"},[e._v("Filtro por Categorías")])]),i("q-card-section",[e._l(e.categories,(function(t,o){return i("q-expansion-item",{key:t.id,attrs:{popup:"",group:"categoryFilter","expand-separator":"","expand-icon-toggle":""},scopedSlots:e._u([{key:"header",fn:function(){return[i("q-item-section",{class:{selected:t.selected,pointer:!0},on:{click:function(i){e.updateProductListWithCategory(t),t.selected=!0}}},[e._v("\r\n              "+e._s(t.name)+"\r\n            ")])]},proxy:!0}],null,!0)},e._l(e.categories[o].subcategories,(function(t){return i("q-item",{key:t.id,class:{selected:t.selected},staticStyle:{"border-radius":"30px"},attrs:{label:t.name}},[i("q-item-section",{staticClass:"pointer q-ml-lg",on:{click:function(i){e.updateProductListWithSubcategory(t),t.selected=!0}}},[e._v("\r\n              "+e._s(t.name)+"\r\n            ")])],1)})),1)})),i("div",{staticClass:"q-ma-md"},[e.activeCategoryFilter?i("q-btn",{staticClass:"text-capitalize",attrs:{color:"positive"},on:{click:function(t){return e.resetCategoryFilter()}}},[e._v("\r\n        Restaurar\r\n        ")]):e._e()],1)],2)],1)],1),i("div",{staticClass:"col-9"},[i("q-card",{staticClass:"table-bg no-shadow"},[i("q-card-section",[i("div",{staticClass:"text-h6"},[e._v("Productos")])]),i("q-separator",{attrs:{color:"white"}}),i("q-card-section",{staticClass:"q-pa-none"},[i("q-table",{staticClass:"table-bg",attrs:{data:e.products,columns:e.columns,"visible-columns":e.visibleColumns,filter:e.filter,pagination:e.pagination},scopedSlots:e._u([{key:"top-left",fn:function(){return[i("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0},{key:"top-right",fn:function(){return[i("q-btn",{staticClass:"float-right text-capitalize",attrs:{color:"positive",icon:"add"},on:{click:function(t){e.addProductDialog=!0}}})]},proxy:!0},{key:"body-cell-Action",fn:function(t){return[i("q-td",{attrs:{props:t}},[i("q-btn",{staticClass:"q-ml-sm",attrs:{icon:"share",size:"sm",flat:"",dense:""},on:{click:function(i){return e.relateProduct(t.row)}}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{icon:"edit",size:"sm",flat:"",dense:""},on:{click:function(i){return e.editProduct(t.row)}}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{icon:"delete",size:"sm",flat:"",dense:""},on:{click:function(i){return e.deleteProduct(t.row)}}})],1)]}},{key:"body-cell-Description",fn:function(t){return[i("q-td",{attrs:{props:t}},[e._v("\r\n            "+e._s(t.row.description.substr(0,10)+"…")+"\r\n          ")])]}},{key:"body-cell-Image",fn:function(t){return[i("q-td",{attrs:{props:t}},[t.row.image_url?i("q-img",{attrs:{src:"http://localhost:3000/images/"+t.row.image_url,height:"auto",width:"100px",ratio:1}}):e._e()],1)]}},{key:"body-cell-Active",fn:function(t){return[i("q-td",{attrs:{props:t}},[i("q-checkbox",{attrs:{disable:""},model:{value:t.row.active,callback:function(i){e.$set(t.row,"active",i)},expression:"props.row.active"}})],1)]}},{key:"body-cell-Stock",fn:function(t){return[i("q-td",{attrs:{props:t}},[i("q-checkbox",{attrs:{disable:""},model:{value:t.row.stock,callback:function(i){e.$set(t.row,"stock",i)},expression:"props.row.stock"}})],1)]}}])})],1),i("q-dialog",{attrs:{persistent:""},model:{value:e.addProductDialog,callback:function(t){e.addProductDialog=t},expression:"addProductDialog"}},[i("q-card",{staticStyle:{"min-width":"750px"}},[i("q-card-section",[i("div",{staticClass:"text-h6"},[e._v(e._s(e.formTitle))])]),i("q-card-section",{staticClass:"q-pt-none"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col q-mx-sm"},[i("q-input",{attrs:{dense:"",label:"Nombre"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})],1),i("div",{staticClass:"col q-mx-sm"},[i("q-input",{attrs:{dense:"",label:"Precio"},model:{value:e.editedItem.price,callback:function(t){e.$set(e.editedItem,"price",t)},expression:"editedItem.price"}})],1)]),i("div",{staticClass:"row q-mt-md"},[i("div",{staticClass:"col q-mx-sm"},[i("q-input",{attrs:{dense:"",clearable:"",autogrow:"",label:"Descripción",type:"textarea"},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],1)]),i("div",{staticClass:"row q-mt-md justify-center"},[i("div",{staticClass:"col-6 q-mx-sm"},[i("q-checkbox",{attrs:{label:"Activo?","left-label":""},model:{value:e.editedItem.active,callback:function(t){e.$set(e.editedItem,"active",t)},expression:"editedItem.active"}})],1),i("div",{staticClass:"col-6 q-mx-sm"},[i("q-checkbox",{attrs:{label:"Tiene Stock?","left-label":""},model:{value:e.editedItem.stock,callback:function(t){e.$set(e.editedItem,"stock",t)},expression:"editedItem.stock"}})],1)]),i("div",{staticClass:"row q-mt-md justify-center"},[i("div",{staticClass:"col-6 q-mx-sm"},[i("q-file",{attrs:{rounded:"",outlined:"",type:"file","bottom-slots":"",label:"Foto",counter:"","max-file-size":"2097152","max-files":"1",accept:".jpg, image/*"},on:{rejected:e.onRejected},scopedSlots:e._u([{key:"before",fn:function(){return[i("q-icon",{attrs:{name:"attachment"}})]},proxy:!0},{key:"append",fn:function(){return[null!==e.editedItem.image_url?i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(t){t.stopPropagation(),e.editedItem.image_url=null}}}):e._e(),i("q-icon",{attrs:{name:"search"},on:{click:function(e){e.stopPropagation()}}})]},proxy:!0},{key:"hint",fn:function(){return[e._v(" Tamaño máximo 2MB ")]},proxy:!0}]),model:{value:e.editedItem.file,callback:function(t){e.$set(e.editedItem,"file",t)},expression:"editedItem.file"}})],1)])]),i("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",label:"Cancelar"},on:{click:e.closeNewProductDialog}}),i("q-btn",{attrs:{flat:"",label:e.formTitle},on:{click:e.saveNewProduct}})],1)],1)],1),i("q-dialog",{attrs:{persistent:""},model:{value:e.relateProductDialog,callback:function(t){e.relateProductDialog=t},expression:"relateProductDialog"}},[i("q-card",{staticStyle:{"min-width":"750px"}},[i("q-card-section",[i("div",{staticClass:"text"},[e._v("Seleccionar Categoria/s o Subcategoría/s a relacionar")])]),i("q-card-section",{staticClass:"scroll"},[e._l(e.categories,(function(t,o){return i("q-expansion-item",{key:t.id,attrs:{popup:"",group:"categoryRelations","expand-separator":"","expand-icon-toggle":""},scopedSlots:e._u([{key:"header",fn:function(){return[i("q-item-section",{staticClass:"pointer",on:{click:function(i){return e.setSelectedCategories(t)}}},[e._v("\r\n              "+e._s(t.name)+"\r\n            ")])]},proxy:!0}],null,!0)},e._l(e.categories[o].subcategories,(function(o){return i("q-item",{key:o.id,attrs:{label:o.name}},[i("q-item-section",{staticClass:"pointer",on:{click:function(i){return e.setSelectedSubcategories(t,o)}}},[e._v("\r\n              "+e._s(o.name)+"\r\n            ")])],1)})),1)})),i("div",[i("div",{staticClass:"text"},[e._v("Categorías seleccionadas")]),e._l(e.selectedCategories,(function(t,o){return i("q-chip",{key:t.id,attrs:{removable:"",label:t.name,icon:"bookmark",color:"blue","text-color":"white"},on:{remove:function(i){return e.unsetSelectedCategories(t,o)}}})}))],2),i("div",[i("div",{staticClass:"text"},[e._v("Subcategorías seleccionadas")]),e._l(e.selectedSubcategories,(function(t,o){return i("q-chip",{key:t.id,attrs:{removable:"",label:t.name,icon:"bookmark",color:"red","text-color":"white"},on:{remove:function(t){return e.selectedSubcategories.splice(o,1)}}})}))],2)],2),i("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",label:"Cancelar"},on:{click:e.closeRelationDialog}}),i("q-btn",{attrs:{flat:"",label:"Relacionar Subcategorias"},on:{click:e.saveNewSubcategoryRelation}})],1)],1)],1)],1)],1)])},a=[],c=(i("d81d"),i("b0c0"),i("cca6"),i("a434"),i("159b"),i("a4d3"),i("e01a"),i("7db0"),i("758b")),s={name:"ProductsTable",created:function(){this.getProducts(),this.getCategories(),this.getSubcategories()},data:function(){return{products:[],categories:[],subcategories:[],selectedCategories:[],selectedSubcategories:[],filter:"",activeCategoryFilter:!1,subcategoryFilter:[],columns:[{name:"Id",label:"ID",field:"id",sortable:!0,align:"left"},{name:"Image",label:"",field:"image_url",sortable:!0,align:"left"},{name:"Name",label:"Nombre",field:"name",sortable:!0,align:"left"},{name:"Price",label:"Precio",field:"price",sortable:!0,align:"left"},{name:"Description",label:"Descripción",field:"description",sortable:!0,align:"left"},{name:"Active",label:"Activo",field:"active",sortable:!0,align:"center"},{name:"Stock",label:"Stock",field:"stock",sortable:!0,align:"center"},{name:"Action",label:"Acciones",field:"Action",sortable:!0,align:"center"},{name:"Subcategories",label:"Subcategorias",field:"subcategories",align:"center"}],visibleColumns:["Id","Name","Price","Description","Active","Stock","Image","Action"],pagination:{rowsPerPage:5},addProductDialog:!1,relateProductDialog:!1,editedIndex:-1,editedItem:{name:"",price:"",description:"",file:null,image_url:"",active:null,stock:null},defaultItem:{name:"",price:"",description:"",file:null,image_url:"",active:null,stock:null}}},computed:{formTitle:function(){return-1===this.editedIndex?"Crear Producto":"Editar Producto"}},methods:{getProducts:function(){var e=this;c["a"].get("products").then((function(t){e.products=t.data})).catch((function(e){console.log("error"+e)}))},getCategories:function(){var e=this;c["a"].get("categories").then((function(t){e.categories=t.data})).catch((function(e){console.log("error"+e)}))},getSubcategories:function(){var e=this;c["a"].get("subcategories").then((function(t){e.subcategories=t.data,e.subcategories=e.subcategories.map((function(e){return e["label"]=e["name"],e["value"]=e["id"],delete e["name"],delete e["id"],e}))})).catch((function(e){console.log("error"+e)}))},editProduct:function(e){this.editedIndex=this.products.indexOf(e),this.editedItem=Object.assign({},e),this.addProductDialog=!0},deleteProduct:function(e){var t=this.products.indexOf(e),i=this.products[t].id;confirm("Estás seguro que querés eliminar este producto?")&&this.products.splice(t,1)&&c["a"].delete("products/deleteProduct/".concat(i)).catch((function(e){console.log(e.response)}))},relateProduct:function(e){var t=this;this.relateProductDialog=!0,this.editedIndex=this.products.indexOf(e),this.products[this.editedIndex].categories.forEach((function(e){t.selectedCategories.push(e)})),this.products[this.editedIndex].subcategories.forEach((function(e){t.selectedSubcategories.push(e)}))},closeNewProductDialog:function(){var e=this;this.addProductDialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},closeRelationDialog:function(){var e=this;this.relateProductDialog=!1,this.$nextTick((function(){e.selectedCategories=[],e.selectedSubcategories=[]}))},saveNewProduct:function(){var e=this,t=new FormData;if(t.set("name",this.editedItem.name),t.set("price",this.editedItem.price),t.set("description",this.editedItem.description),t.set("active",this.editedItem.active),t.set("stock",this.editedItem.stock),t.append("file",this.editedItem.file),this.editedIndex>-1){var i=this.editedIndex;c["a"].put("products/editProduct/".concat(this.products[i].id),t).then((function(t){Object.assign(e.products[i],{id:t.data.id,name:t.data.name,price:t.data.price,description:t.data.description,file:null,image_url:t.data.image_url,active:t.data.active,stock:t.data.stock})})).catch((function(e){console.log(e)}))}else c["a"].post("products/addProduct",t).then((function(t){e.products.push({id:t.data.id,name:t.data.name,price:t.data.price,description:t.data.description,file:null,image_url:t.data.image_url,active:t.data.active,stock:t.data.stock})})).catch((function(e){console.log(e.response.data.errors.message)}));this.closeNewProductDialog()},setSelectedCategories:function(e){void 0===this.selectedCategories.find((function(t){return t.id==e.id}))&&this.selectedCategories.push(e)},setSelectedSubcategories:function(e,t){void 0===this.selectedCategories.find((function(t){return t.id==e.id}))&&this.selectedCategories.push(e),void 0===this.selectedSubcategories.find((function(e){return e.id==t.id}))&&this.selectedSubcategories.push(t)},unsetSelectedCategories:function(e,t){var i=this;this.selectedCategories.splice(t,1);var o=this.categories.find((function(t){return t.id==e.id})).subcategories;o.forEach((function(e){var t=i.selectedSubcategories.indexOf(i.selectedSubcategories.find((function(t){return t.id==e.id})));t>=0&&i.selectedSubcategories.splice(t,1)}))},saveNewSubcategoryRelation:function(){var e=this,t=this.editedIndex;this.products[t].categories.forEach((function(i){var o=e.selectedCategories.some((function(e){return e.id==i.id}));o||c["a"].post("products/separateProductFromCategory",{productId:e.products[t].id,categoryId:i.id})})),this.products[t].subcategories.forEach((function(i){var o=e.selectedSubcategories.some((function(e){return e.id==i.id}));o||c["a"].post("products/separateProductFromSubcategory",{productId:e.products[t].id,subcategoryId:i.id})})),this.selectedSubcategories.forEach((function(i){var o=e.products[t].subcategories.some((function(e){return e.id==i.id}));o||c["a"].post("products/relateProductToSubcategory",{productId:e.products[t].id,subcategoryId:i.id})})),this.selectedCategories.forEach((function(i){var o=e.products[t].categories.some((function(e){return e.id==i.id}));o||c["a"].post("products/relateProductToCategory",{productId:e.products[t].id,categoryId:i.id})})),c["a"].get("products").then((function(t){e.products=t.data,e.closeRelationDialog()})).catch((function(e){console.log("error"+e)}))},updateProductListWithCategory:function(e){var t=this;this.categories.forEach((function(e){e.selected=!1,e.subcategories.forEach((function(e){e.selected=!1}))})),this.activeCategoryFilter=!0,c["a"].get("products/findForCategory/".concat(e.id)).then((function(e){t.products=e.data})).catch((function(e){console.log("error"+e)}))},updateProductListWithSubcategory:function(e){var t=this;this.categories.forEach((function(e){e.selected=!1,e.subcategories.forEach((function(e){e.selected=!1}))})),this.activeCategoryFilter=!0,c["a"].get("products/findForSubcategory/".concat(e.id)).then((function(e){t.products=e.data})).catch((function(e){console.log("error"+e)}))},resetCategoryFilter:function(){var e=this;c["a"].get("products").then((function(t){e.products=t.data,e.activeCategoryFilter=!1,e.categories.forEach((function(e){e.selected=!1,e.subcategories.forEach((function(e){e.selected=!1}))}))})).catch((function(e){console.log("error"+e)}))},onRejected:function(){this.$q.notify({type:"negative",message:"Archivo no permitido"})}}},r=s,n=(i("dee7"),i("2877")),d=i("f09f"),l=i("a370"),u=i("3b73"),p=i("66e5"),f=i("4074"),g=i("9c40"),m=i("eb85"),b=i("eaac"),h=i("27f9"),v=i("0016"),C=i("db86"),k=i("068f"),q=i("8f8e"),x=i("24e8"),y=i("7d53"),I=i("4b7e"),S=i("b047"),P=i("eebe"),_=i.n(P),w=Object(n["a"])(r,o,a,!1,null,null,null);t["default"]=w.exports;_()(w,"components",{QCard:d["a"],QCardSection:l["a"],QExpansionItem:u["a"],QItem:p["a"],QItemSection:f["a"],QBtn:g["a"],QSeparator:m["a"],QTable:b["a"],QInput:h["a"],QIcon:v["a"],QTd:C["a"],QImg:k["a"],QCheckbox:q["a"],QDialog:x["a"],QFile:y["a"],QCardActions:I["a"],QChip:S["a"]})},d94c:function(e,t,i){},dee7:function(e,t,i){"use strict";i("d94c")}}]);